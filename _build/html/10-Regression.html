
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Regression and Models &#8212; MATH 550 - Applied Probability and Statistics</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">MATH 550 - Applied Probability and Statistics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01-Introduction.html">
   Introduction and Course Syllabus
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="02-What_is_Stats.html">
   What is Statistics?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Discrete_Probability.html">
   Discrete Random Variables - The Binomial Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-Geometric_and_Poisson.html">
   Geometric and Poisson Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Continuous.html">
   Continuous Random Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-Gamma_and_beta.html">
   Gamma and Beta Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07-Sampling.html">
   Sampling from Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-Confidence_Hypothesis.html">
   Confidence Intervals and Hypothesis Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09-Bayes_Theorem.html">
   Bayes Theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="99-Apendices.html">
   Class Schedule and Activities
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/10-Regression.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/10-Regression.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confidence-intervals-around-a-regression">
   Confidence Intervals Around a Regression
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="regression-and-models">
<h1>Regression and Models<a class="headerlink" href="#regression-and-models" title="Permalink to this headline">Â¶</a></h1>
<p>So far most of our results have been looking at single variate statistics and distributions. Even in the case when we looked at multivariate distributions we were taking the point of view that the distribution was describing our sampling procedure and that the variables were independent. However often we are confronted with data describing two variables from the members of our population and the task then is to see if there is a relationship between the variables, and if there is to describe it or model it.</p>
<p>A nice example that is coded as part of the standard installation in R is the cars dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the ggplot2 package</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 Ã 11</caption>
<thead>
	<tr><th scope=col>manufacturer</th><th scope=col>model</th><th scope=col>displ</th><th scope=col>year</th><th scope=col>cyl</th><th scope=col>trans</th><th scope=col>drv</th><th scope=col>cty</th><th scope=col>hwy</th><th scope=col>fl</th><th scope=col>class</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>audi</td><td>a4</td><td>1.8</td><td>1999</td><td>4</td><td>auto(l5)  </td><td>f</td><td>18</td><td>29</td><td>p</td><td>compact</td></tr>
	<tr><td>audi</td><td>a4</td><td>1.8</td><td>1999</td><td>4</td><td>manual(m5)</td><td>f</td><td>21</td><td>29</td><td>p</td><td>compact</td></tr>
	<tr><td>audi</td><td>a4</td><td>2.0</td><td>2008</td><td>4</td><td>manual(m6)</td><td>f</td><td>20</td><td>31</td><td>p</td><td>compact</td></tr>
	<tr><td>audi</td><td>a4</td><td>2.0</td><td>2008</td><td>4</td><td>auto(av)  </td><td>f</td><td>21</td><td>30</td><td>p</td><td>compact</td></tr>
	<tr><td>audi</td><td>a4</td><td>2.8</td><td>1999</td><td>6</td><td>auto(l5)  </td><td>f</td><td>16</td><td>26</td><td>p</td><td>compact</td></tr>
	<tr><td>audi</td><td>a4</td><td>2.8</td><td>1999</td><td>6</td><td>manual(m5)</td><td>f</td><td>18</td><td>26</td><td>p</td><td>compact</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We are interested in explaining the relationship between the engine displacement of a car and its highway fuel effeciency:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span> <span class="n">x</span> <span class="o">=</span> <span class="n">displ</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">hwy</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/10-Regression_4_0.png" src="_images/10-Regression_4_0.png" />
</div>
</div>
<p>It appears that there is something of a linear relationship between these two variables but it is not an exact relationship. Note that the displacement variable in this example is not random - it is a feature of the cars design. We are going to think of the relationship as:</p>
<div class="math notranslate nohighlight">
\[ \mbox{hwy} = a \cdot \mbox{displ} + b + \mbox{Error} \]</div>
<p>where the <span class="math notranslate nohighlight">\(\mbox{Error}\)</span> variable is modeled as a random variable. In truth what it encapsulates is all of the other variables that translate into a carâs highway fuel effeciency, but given that we do not know most of these variables for this data, it is helpful to think of them all as adding up to some random effect on the highway effeciency.</p>
<p>Our task is to choose <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> such that the variable <span class="math notranslate nohighlight">\(\mbox{Error}\)</span> is controlled. Typically this would mean that we want its variance to be minimized. The advantage of minimizing <span class="math notranslate nohighlight">\(\mbox{variance}\)</span> is that it will bring in some techniques from Calculus that we can use in finding minimums.</p>
<p>To start note that we can choose <span class="math notranslate nohighlight">\(b\)</span> such that the mean of the <span class="math notranslate nohighlight">\(\mbox{Error}\)</span> term is 0. Therefore the task of minimizing its variance is to minimize the Total Squared Error:</p>
<div class="math notranslate nohighlight">
\[ TSE = \sum_{data} \mbox{Error}^2 \]</div>
<p>Fix one of our data points as <span class="math notranslate nohighlight">\( (x_0, y_0)\)</span>.
Let <span class="math notranslate nohighlight">\(\hat{y} = a x +b \)</span> then we have</p>
<div class="math notranslate nohighlight">
\[ TSE = \sum_{i} ( y_i - \hat{y}_i)^2 = \sum_{i} ( y_i - a x_i - b)^2 \]</div>
<p>We note that this is a quadratic function of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> and therefore it will have a single minimum as a critical point unless we are in a degenerate case. When we have finished finding <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> in the generic case we will say a bit about what a degenerate case would look like, but you might be able to make a hypothesis about it.</p>
<p>Critical points of <span class="math notranslate nohighlight">\(TSE\)</span> will occur when the partial derrivatives with respect to <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are both 0. So we are trying to solve the system of equations:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial TSE}{\partial a} = - \sum_i 2 x_i (y_i - a x_i - b) = 0 \]</div>
<div class="math notranslate nohighlight">
\[ \frac{\partial TSE}{\partial b} = - \sum_i 2 (y_i - a x_i - b) = 0 \]</div>
<p>This is sort of a pain to do without using some techniques from linear algebra, however what you should be able to convince yourself of is that this system is linear in <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, and therefore unless we are in a degenerate case there will be a unique solution. And that using linear algebra there is a procedure for finding this unique solution.</p>
<p>R has the solution to linear (and other types of regression) encoded with the <em>lm</em> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span> <span class="n">hwy</span> <span class="o">~</span> <span class="n">displ</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mpg</span><span class="p">)</span>
<span class="n">out</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = hwy ~ displ, data = mpg)

Coefficients:
(Intercept)        displ  
     35.698       -3.531  
</pre></div>
</div>
</div>
</div>
<p>The result of lm can be plotted with the data. The <em>se = FALSE</em> option turns off the error region on the estimate, in a moment we will explain how that is computed and then we can use it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> 
    <span class="nf">geom_point</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span> <span class="n">x</span> <span class="o">=</span> <span class="n">displ</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">hwy</span> <span class="p">))</span> <span class="o">+</span>
    <span class="nf">geom_smooth</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="n">displ</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">hwy</span> <span class="p">),</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;lm&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">se</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`geom_smooth()` using formula &#39;y ~ x&#39;
</pre></div>
</div>
<img alt="_images/10-Regression_8_1.png" src="_images/10-Regression_8_1.png" />
</div>
</div>
<p>The ouput of the <em>lm</em> command contains information about the error from each point, the residuals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">out[[</span><span class="s">&#39;residuals&#39;</span><span class="n">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>1</dt><dd>-0.342591200740745</dd><dt>2</dt><dd>-0.342591200740575</dd><dt>3</dt><dd>2.36352656049326</dd><dt>4</dt><dd>1.36352656049326</dd><dt>5</dt><dd>0.1879976054284</dd><dt>6</dt><dd>0.1879976054284</dd><dt>7</dt><dd>2.24717424727908</dd><dt>8</dt><dd>-3.34259120074052</dd><dt>9</dt><dd>-4.34259120074052</dd><dt>10</dt><dd>-0.636473439506736</dd><dt>11</dt><dd>-1.63647343950674</dd><dt>12</dt><dd>-0.8120023945716</dd><dt>13</dt><dd>-0.8120023945716</dd><dt>14</dt><dd>0.247174247279078</dd><dt>15</dt><dd>0.247174247279078</dd><dt>16</dt><dd>-1.8120023945716</dd><dt>17</dt><dd>0.247174247279078</dd><dt>18</dt><dd>2.13082193406489</dd><dt>19</dt><dd>3.0144696208507</dd><dt>20</dt><dd>-1.9855303791493</dd><dt>21</dt><dd>3.0144696208507</dd><dt>22</dt><dd>1.42670514331827</dd><dt>23</dt><dd>2.48588178516895</dd><dt>24</dt><dd>10.4267051433183</dd><dt>25</dt><dd>7.42670514331827</dd><dt>26</dt><dd>12.1919995464027</dd><dt>27</dt><dd>11.1919995464027</dd><dt>28</dt><dd>13.0164705913379</dd><dt>29</dt><dd>2.0144696208507</dd><dt>30</dt><dd>-2.9855303791493</dd><dt>31</dt><dd>-0.573294856681726</dd><dt>32</dt><dd>4.25117618825341</dd><dt>33</dt><dd>-0.224237917039168</dd><dt>34</dt><dd>2.77576208296083</dd><dt>35</dt><dd>1.24717424727908</dd><dt>36</dt><dd>5.65940976974665</dd><dt>37</dt><dd>3.01246865036354</dd><dt>38</dt><dd>-3.22423791703917</dd><dt>39</dt><dd>-1.10588463333781</dd><dt>40</dt><dd>-2.04670799148714</dd><dt>41</dt><dd>-2.04670799148714</dd><dt>42</dt><dd>-0.0467079914871388</dd><dt>43</dt><dd>-0.0467079914871388</dd><dt>44</dt><dd>-7.04670799148714</dd><dt>45</dt><dd>-0.281413588402678</dd><dt>46</dt><dd>-1.28141358840268</dd><dt>47</dt><dd>0.718586411597322</dd><dt>48</dt><dd>1.42470417283111</dd><dt>49</dt><dd>-3.63447246901957</dd><dt>50</dt><dd>-4.63447246901957</dd><dt>51</dt><dd>-4.92835470778579</dd><dt>52</dt><dd>-4.92835470778579</dd><dt>53</dt><dd>-0.103883662850648</dd><dt>54</dt><dd>-0.103883662850648</dd><dt>55</dt><dd>-7.10388366285065</dd><dt>56</dt><dd>-0.338589259766187</dd><dt>57</dt><dd>-2.33858925976619</dd><dt>58</dt><dd>-4.92835470778579</dd><dt>59</dt><dd>-2.10388366285065</dd><dt>60</dt><dd>-7.10388366285065</dd><dt>61</dt><dd>-2.10388366285065</dd><dt>62</dt><dd>-1.33858925976619</dd><dt>63</dt><dd>2.42670514331827</dd><dt>64</dt><dd>0.132822904552058</dd><dt>65</dt><dd>-3.10388366285065</dd><dt>66</dt><dd>-7.10388366285065</dd><dt>67</dt><dd>-2.10388366285065</dd><dt>68</dt><dd>-2.10388366285065</dd><dt>69</dt><dd>-3.10388366285065</dd><dt>70</dt><dd>-7.10388366285065</dd><dt>71</dt><dd>-2.33858925976619</dd><dt>72</dt><dd>-1.33858925976619</dd><dt>73</dt><dd>1.42670514331827</dd><dt>74</dt><dd>0.132822904552058</dd><dt>75</dt><dd>-2.45694254346754</dd><dt>76</dt><dd>0.367528501467598</dd><dt>77</dt><dd>1.3675285014676</dd><dt>78</dt><dd>-4.57529582716889</dd><dt>79</dt><dd>-2.57529582716889</dd><dt>80</dt><dd>-4.57529582716889</dd><dt>81</dt><dd>-2.57529582716889</dd><dt>82</dt><dd>-0.456942543467542</dd><dt>83</dt><dd>-1.04470702099997</dd><dt>84</dt><dd>-3.86917806593511</dd><dt>85</dt><dd>-3.86917806593511</dd><dt>86</dt><dd>-3.45694254346754</dd><dt>87</dt><dd>-3.45694254346754</dd><dt>88</dt><dd>-2.45694254346754</dd><dt>89</dt><dd>-1.6324714985324</dd><dt>90</dt><dd>0.367528501467598</dd><dt>91</dt><dd>3.71858641159732</dd><dt>92</dt><dd>2.71858641159732</dd><dt>93</dt><dd>4.42470417283111</dd><dt>94</dt><dd>2.42470417283111</dd><dt>95</dt><dd>1.54305745653246</dd><dt>96</dt><dd>2.54305745653246</dd><dt>97</dt><dd>3.54305745653246</dd><dt>98</dt><dd>2.54305745653246</dd><dt>99</dt><dd>3.3675285014676</dd><dt>100</dt><dd>2.9512910380257</dd><dt>101</dt><dd>1.9512910380257</dd><dt>102</dt><dd>1.9512910380257</dd><dt>103</dt><dd>-1.0487089619743</dd><dt>104</dt><dd>1.9512910380257</dd><dt>105</dt><dd>4.65740879925948</dd><dt>106</dt><dd>6.65740879925948</dd><dt>107</dt><dd>6.65740879925948</dd><dt>108</dt><dd>0.363526560493264</dd><dt>109</dt><dd>-1.22423791703917</dd><dt>110</dt><dd>-0.224237917039168</dd><dt>111</dt><dd>2.77576208296083</dd><dt>112</dt><dd>3.77576208296083</dd><dt>113</dt><dd>-0.871179036422275</dd><dt>114</dt><dd>-0.871179036422275</dd><dt>115</dt><dd>3.95329200851286</dd><dt>116</dt><dd>-2.63647343950674</dd><dt>117</dt><dd>0.363526560493264</dd><dt>118</dt><dd>-0.636473439506736</dd><dt>119</dt><dd>-1.63647343950674</dd><dt>120</dt><dd>-2.16506127518849</dd><dt>121</dt><dd>-2.16506127518849</dd><dt>122</dt><dd>-2.16506127518849</dd><dt>123</dt><dd>-3.10588463333781</dd><dt>124</dt><dd>-3.63447246901957</dd><dt>125</dt><dd>-1.57529582716889</dd><dt>126</dt><dd>-2.10388366285065</dd><dt>127</dt><dd>-7.10388366285065</dd><dt>128</dt><dd>-0.103883662850648</dd><dt>129</dt><dd>2.42670514331827</dd><dt>130</dt><dd>-0.161059334214159</dd><dt>131</dt><dd>-6.57529582716889</dd><dt>132</dt><dd>-2.86917806593511</dd><dt>133</dt><dd>-2.16306030470132</dd><dt>134</dt><dd>-4.45694254346754</dd><dt>135</dt><dd>0.367528501467598</dd><dt>136</dt><dd>-0.632471498532402</dd><dt>137</dt><dd>1.3675285014676</dd><dt>138</dt><dd>-4.57529582716889</dd><dt>139</dt><dd>-2.57529582716889</dd><dt>140</dt><dd>-0.456942543467542</dd><dt>141</dt><dd>-1.04470702099997</dd><dt>142</dt><dd>1.77576208296083</dd><dt>143</dt><dd>-0.224237917039168</dd><dt>144</dt><dd>4.12882096357772</dd><dt>145</dt><dd>5.12882096357772</dd><dt>146</dt><dd>3.65940976974665</dd><dt>147</dt><dd>2.65940976974665</dd><dt>148</dt><dd>0.894115366662186</dd><dt>149</dt><dd>-0.105884633337814</dd><dt>150</dt><dd>1.65940976974665</dd><dt>151</dt><dd>-7.04670799148714</dd><dt>152</dt><dd>-7.04670799148714</dd><dt>153</dt><dd>-1.57529582716889</dd><dt>154</dt><dd>2.07364626270138</dd><dt>155</dt><dd>1.24717424727908</dd><dt>156</dt><dd>3.71858641159732</dd><dt>157</dt><dd>4.71858641159732</dd><dt>158</dt><dd>5.71858641159732</dd><dt>159</dt><dd>8.0144696208507</dd><dt>160</dt><dd>-1.87117903642228</dd><dt>161</dt><dd>-2.87117903642228</dd><dt>162</dt><dd>0.128820963577725</dd><dt>163</dt><dd>-1.87117903642228</dd><dt>164</dt><dd>-0.871179036422275</dd><dt>165</dt><dd>-3.87117903642228</dd><dt>166</dt><dd>-1.93035567827295</dd><dt>167</dt><dd>-1.93035567827295</dd><dt>168</dt><dd>-0.871179036422275</dd><dt>169</dt><dd>-0.871179036422275</dd><dt>170</dt><dd>-1.87117903642228</dd><dt>171</dt><dd>0.128820963577725</dd><dt>172</dt><dd>-1.87117903642228</dd><dt>173</dt><dd>0.128820963577725</dd><dt>174</dt><dd>-6.16506127518849</dd><dt>175</dt><dd>-6.16506127518849</dd><dt>176</dt><dd>-4.69364911087025</dd><dt>177</dt><dd>-6.69364911087025</dd><dt>178</dt><dd>-1.57529582716889</dd><dt>179</dt><dd>-2.10388366285065</dd><dt>180</dt><dd>1.06964432172705</dd><dt>181</dt><dd>-0.930355678272951</dd><dt>182</dt><dd>3.77576208296083</dd><dt>183</dt><dd>3.77576208296083</dd><dt>184</dt><dd>0.894115366662186</dd><dt>185</dt><dd>0.894115366662186</dd><dt>186</dt><dd>4.65940976974665</dd><dt>187</dt><dd>-0.930355678272951</dd><dt>188</dt><dd>1.06964432172705</dd><dt>189</dt><dd>3.77576208296083</dd><dt>190</dt><dd>3.77576208296083</dd><dt>191</dt><dd>0.894115366662186</dd><dt>192</dt><dd>0.894115366662186</dd><dt>193</dt><dd>2.95329200851286</dd><dt>194</dt><dd>0.657408799259481</dd><dt>195</dt><dd>3.65740879925948</dd><dt>196</dt><dd>5.65740879925948</dd><dt>197</dt><dd>7.65740879925948</dd><dt>198</dt><dd>5.65740879925948</dd><dt>199</dt><dd>-4.10388366285065</dd><dt>200</dt><dd>2.42670514331827</dd><dt>201</dt><dd>-6.16506127518849</dd><dt>202</dt><dd>-6.16506127518849</dd><dt>203</dt><dd>-4.16506127518849</dd><dt>204</dt><dd>-6.69364911087025</dd><dt>205</dt><dd>-4.69364911087025</dd><dt>206</dt><dd>-3.57529582716889</dd><dt>207</dt><dd>-1.57529582716889</dd><dt>208</dt><dd>0.363526560493264</dd><dt>209</dt><dd>-2.63647343950674</dd><dt>210</dt><dd>0.363526560493264</dd><dt>211</dt><dd>0.363526560493264</dd><dt>212</dt><dd>-1.8120023945716</dd><dt>213</dt><dd>15.0104676798764</dd><dt>214</dt><dd>0.363526560493264</dd><dt>215</dt><dd>-2.63647343950674</dd><dt>216</dt><dd>0.363526560493264</dd><dt>217</dt><dd>0.363526560493264</dd><dt>218</dt><dd>2.12882096357772</dd><dt>219</dt><dd>2.12882096357772</dd><dt>220</dt><dd>-2.8120023945716</dd><dt>221</dt><dd>-1.8120023945716</dd><dt>222</dt><dd>15.0104676798764</dd><dt>223</dt><dd>12.0104676798764</dd><dt>224</dt><dd>0.363526560493264</dd><dt>225</dt><dd>-2.63647343950674</dd><dt>226</dt><dd>1.12882096357772</dd><dt>227</dt><dd>2.12882096357772</dd><dt>228</dt><dd>-0.342591200740519</dd><dt>229</dt><dd>-0.342591200740519</dd><dt>230</dt><dd>-0.636473439506736</dd><dt>231</dt><dd>0.363526560493264</dd><dt>232</dt><dd>0.1879976054284</dd><dt>233</dt><dd>0.1879976054284</dd><dt>234</dt><dd>3.01246865036354</dd></dl>
</div></div>
</div>
<p>and summing over the square of these residuals gives the TSE we have minimized:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">TSE</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span> <span class="n">out[[</span><span class="s">&#39;residuals&#39;</span><span class="n">]]^2</span><span class="p">)</span>
<span class="n">TSE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">3413.82900899547</div></div>
</div>
<div class="section" id="confidence-intervals-around-a-regression">
<h2>Confidence Intervals Around a Regression<a class="headerlink" href="#confidence-intervals-around-a-regression" title="Permalink to this headline">Â¶</a></h2>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>