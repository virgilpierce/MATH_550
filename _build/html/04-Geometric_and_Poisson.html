
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Geometric and Poisson Distributions &#8212; MATH 550 - Applied Probability and Statistics</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Continuous Random Variables" href="05-Continuous.html" />
    <link rel="prev" title="Discrete Random Variables - The Binomial Distribution" href="03-Discrete_Probability.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">MATH 550 - Applied Probability and Statistics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01-Introduction.html">
   Introduction and Course Syllabus
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="02-What_is_Stats.html">
   What is Statistics?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Discrete_Probability.html">
   Discrete Random Variables - The Binomial Distribution
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Geometric and Poisson Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Continuous.html">
   Continuous Random Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-Gamma_and_beta.html">
   Gamma and Beta Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07-Sampling.html">
   Sampling from Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-Confidence_Hypothesis.html">
   Confidence Intervals and Hypothesis Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="99-Apendices.html">
   Class Schedule and Activities
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/04-Geometric_and_Poisson.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/04-Geometric_and_Poisson.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geometric-distributions">
   Geometric Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#expected-value">
     Expected Value
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exact-value">
       Exact Value
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variance">
     Variance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Exact Value
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#poisson-distributions">
   Poisson Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-have-we-learned">
     What have we learned?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-the-distribution">
       Plotting the Distribution
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cummulative-distribution">
       Cummulative Distribution
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Expected Value
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variance-of-the-poisson-random-variable">
     Variance of the Poisson Random Variable
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-cummulative-distribution">
   Using the Cummulative Distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#moments-and-moment-generating-functions">
   Moments and Moment Generating Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moment-generating-for-a-poisson-distribution">
     Moment Generating for a Poisson Distribution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-have-we-skipped">
   What have we skipped?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="geometric-and-poisson-distributions">
<h1>Geometric and Poisson Distributions<a class="headerlink" href="#geometric-and-poisson-distributions" title="Permalink to this headline">¶</a></h1>
<p>We can use the Bernouli Trials we met in the last chapter to build two other distributions that describe common situations (and also have enough symmetry they are computable).</p>
<div class="section" id="geometric-distributions">
<h2>Geometric Distributions<a class="headerlink" href="#geometric-distributions" title="Permalink to this headline">¶</a></h2>
<p>This question worked better in Texas than it does in Colorado because of mail in voting, but still:  We are trying to quickly estimate what proportion of voters in Greeley are casting their ballots for candidate A running for mayor of the city. We do this by standing outside a voting location and asking candidates whether they voted for A or B and counting how many people we have to ask before we find our first person voting for A. Say for example that the 4th person we ask says they are voting for candidate A.</p>
<p>Let’s see if we can use that number to estimate what proportion of the population p is voting for A.</p>
<p>Assuming that our sample is random (and note that’s the problem with Colorado voting) we could think of each time we ask a voter leaving the polling location who they voted for as a Bernouli trial with a probability of success p (granted we don’t know p, but that’s why we study math!).</p>
<p>So the question becomes:  If Y is the number of times we had to conduct our Bernouli trial before we got our first success, what is <span class="math notranslate nohighlight">\(P(Y=4)\)</span>?  Note that in order for trial 4 to be our first success 4 things had to happen - we had to have 3 trials in succession that were failures, each with a probability of 1-p; and then we had to have one trial that was a success with probability p. Provided that these events are independent then the likliehood of all 4 of them happening is just the product of these 4 factors:</p>
<div class="math notranslate nohighlight">
\[ (1-p)^3 p \]</div>
<p>More generally the <em>geometric distribution</em> has a probability distribution function given by, for <span class="math notranslate nohighlight">\(r\geq 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ P(Y=r+1) = (1-p)^{r} p \]</div>
<p>This is fundamentally different from our Binomial Distribution. For the binomial distribution with <span class="math notranslate nohighlight">\(n\)</span> trials the largest the random variable could be is <span class="math notranslate nohighlight">\(n\)</span>. In this case, for our geometric distribution <span class="math notranslate nohighlight">\(Y\)</span> is potentially unbounded.  For every <span class="math notranslate nohighlight">\(r\)</span> the value of <span class="math notranslate nohighlight">\(P(Y=r+1)\)</span> is non-zero (though possibly very small).</p>
<p>It’s helpful to fix a <span class="math notranslate nohighlight">\(p\)</span> and plot the probabilities of <span class="math notranslate nohighlight">\(Y=r+1\)</span> for the first few r.  The thing to notice in the plot is that in order for the random variable to have a chance of getting large, p needs to be small so that there is a large probability of the failures in the trial stacking up. Depending on the value of p you put in, you may need to extend the values r is using by adjusting the 25.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;-</span> <span class="m">0.51</span>
<span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">25</span><span class="p">)</span>
<span class="n">v</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="nf">^</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04-Geometric_and_Poisson_1_0.png" src="_images/04-Geometric_and_Poisson_1_0.png" />
</div>
</div>
<p>So for example:  If candidate A has 0.51 of the population supporting them, the probability that we needed to ask 4 voters before we found the first one voting for candidate A is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;-</span> <span class="m">0.51</span>
<span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="n">^3</span> <span class="o">*</span> <span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.06000099</div></div>
</div>
<p>Meaning if we did this experiment at 100 polling sites or 100 different times, 6 of those times we would expect to wait until the 4th voter. But wait there is more.</p>
<p>What we really care about is the complement of the cummulative distribution:  What is the probability that we had to wait until the 4th or <strong>LATER</strong> voter to find the first vote for A. This is a better way to ask because we are really asking how likely is it that candidate A with 0.51 of the vote, is doing this badly OR worse in the voters we have talked to. Note that the complement of this event is:  What is the probability that we found the first voter for A in 0, 1, 2, or 3 voters questioned?  We can than subtract that number from 1 to answer the question above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">1-0.51</span><span class="p">)</span><span class="n">^0</span> <span class="o">*</span> <span class="m">0.51</span> <span class="o">+</span> <span class="p">(</span><span class="m">1-0.51</span><span class="p">)</span><span class="n">^1</span> <span class="o">*</span> <span class="m">0.51</span> <span class="o">+</span> <span class="p">(</span><span class="m">1-0.51</span><span class="p">)</span><span class="n">^2</span> <span class="o">*</span> <span class="m">0.51</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.882351</div></div>
</div>
<p>R has a cumulative distribution for the geometric distribution coded in <em>pgeom</em> (note that there is an annoying thing in R where its definition of the geometric distribution is off by 1 from others):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pgeom</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">0.51</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.882351</div></div>
</div>
<p>and then subtracking this from 1 we get:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="o">-</span> <span class="nf">pgeom</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">0.51</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.117649</div></div>
</div>
<p>Meaning that even for a candidate with 0.51 of the vote, we are not overly surprised when we have to talk to 4 voters before we find a supporter.</p>
<p>It is interesting to ask, how does this probability change as p changes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span><span class="o">/</span><span class="m">1000</span>
<span class="n">v</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">-</span> <span class="nf">pgeom</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
<span class="c1"># You can safely ignore the warning if you get it, </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in pgeom(2, p):
“NaNs produced”
</pre></div>
</div>
<img alt="_images/04-Geometric_and_Poisson_11_1.png" src="_images/04-Geometric_and_Poisson_11_1.png" />
</div>
</div>
<div class="section" id="expected-value">
<h3>Expected Value<a class="headerlink" href="#expected-value" title="Permalink to this headline">¶</a></h3>
<p>The expected value can be computed exactly, and in this case we sort of prefer to do it that way as note that the one thing computers are not great at is infinite sums and infinite integrals. However the values of the distribution decay exponentially and so we actually do expect sums over the distribution to converge quickly. So we can find the approximate expected value by computing</p>
<div class="math notranslate nohighlight">
\[ \sum_{r=0}^N (r+1) p(r) \]</div>
<p>for a medium to large value of <span class="math notranslate nohighlight">\(N\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">&lt;-</span> <span class="m">100</span>
<span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="n">N</span><span class="p">)</span>
<span class="n">p</span> <span class="o">&lt;-</span> <span class="m">0.51</span>
<span class="nf">sum</span><span class="p">(</span> <span class="p">(</span><span class="n">r</span><span class="m">+1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="n">^r</span> <span class="o">*</span> <span class="n">p</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1.96078431372549</div></div>
</div>
<p>Can you make a prediction about the exact value?</p>
<div class="section" id="exact-value">
<h4>Exact Value<a class="headerlink" href="#exact-value" title="Permalink to this headline">¶</a></h4>
<p>To compute the exact value of the sum, we just do it, using our one trick for adding up infinite sums - <em>write it in terms of a geometric series</em>.</p>
<div class="math notranslate nohighlight">
\[ E(Y) = \sum_{r=0}^\infty (r+1) q^r p = p \frac{d}{dq} \sum_{r=0}^\infty q^{r+1} \]</div>
<p>The sum is now a geometric series and we have a formula for its result:</p>
<div class="math notranslate nohighlight">
\[ E(Y) = p \frac{d}{dq} \left[ \frac{q}{1-q} \right] = \mbox{algebra/calculus or calcugebra} = \frac{1}{p} \]</div>
</div>
</div>
<div class="section" id="variance">
<h3>Variance<a class="headerlink" href="#variance" title="Permalink to this headline">¶</a></h3>
<p>The approximate variance can be found using the formula <span class="math notranslate nohighlight">\(\sigma^2 = V(Y) = E(Y^2) - \mu^2\)</span> with <span class="math notranslate nohighlight">\(\mu = E(Y)\)</span>.  For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">&lt;-</span> <span class="m">100</span>
<span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="n">N</span><span class="p">)</span>
<span class="n">p</span> <span class="o">&lt;-</span> <span class="m">0.51</span>
<span class="nf">sum</span><span class="p">(</span> <span class="p">(</span><span class="n">r</span><span class="m">+1</span><span class="p">)</span><span class="n">^2</span> <span class="o">*</span> <span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="n">^r</span> <span class="o">*</span> <span class="n">p</span> <span class="p">)</span>  <span class="o">-</span> <span class="m">1</span><span class="o">/</span><span class="n">p^2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1.88389081122645</div></div>
</div>
<div class="section" id="id1">
<h4>Exact Value<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>To compute the exact value of the sum:</p>
<div class="math notranslate nohighlight">
\[ \sigma^2 = V(Y) = E(Y^2) - \frac{1}{p^2} = E(Y (Y+1) ) - \frac{1}{p} - \frac{1}{p^2} \]</div>
<p>So we look for:</p>
<div class="math notranslate nohighlight">
\[ E(Y (Y+1) ) = \sum_{r=0}^\infty (r+1) (r+2) q^r p = p \frac{d^2}{dq^2} \sum_{r=0}^\infty q^{r+2} = p \frac{d^2}{dq^2} \frac{q^2}{1-q} \]</div>
<p>Some Calculus and Algebra later:</p>
<div class="math notranslate nohighlight">
\[ E(Y(Y+1)) = \frac{2}{p^2} \]</div>
<p>Putting it all together:</p>
<div class="math notranslate nohighlight">
\[ V(Y) = \frac{2}{p^2} - \frac{1}{p} - \frac{1}{p^2} = \frac{1-p}{p^2} \]</div>
</div>
</div>
</div>
<div class="section" id="poisson-distributions">
<h2>Poisson Distributions<a class="headerlink" href="#poisson-distributions" title="Permalink to this headline">¶</a></h2>
<p>Consider a particular intersection. We are interested in understanding the number of accidents that will happen at this intersection in a week. One way to think about this is to consider that if we break our units of time down to a small enough amount of time that only one accident can happen at a time - say we consider individual minutes. Now that only one accident is possible we could consider <span class="math notranslate nohighlight">\(p\)</span> the probability that an accident occurs in any given minute at this intersection:</p>
<div class="math notranslate nohighlight">
\[ P( \mbox{an accident occurs in a minute}) = p\]</div>
<div class="math notranslate nohighlight">
\[ P( \mbox{no accident occurs in a minute}) = 1- p \]</div>
<div class="math notranslate nohighlight">
\[ P( \mbox{more than one accident occurs in a minute}) = 0 \]</div>
<p>We then take smaller and smaller units of time.</p>
<p>Our implicit assumption here is each subunit of time is an identically distributed independent Bernouli trial. This is probably a shaky assumption, but lets proceed and see what happens.</p>
<p>So for a subunit with <span class="math notranslate nohighlight">\(n\)</span> occurences in a week we have:</p>
<div class="math notranslate nohighlight">
\[ P(Y = r) \sim \binom{n}{r} p^r (1-p)^{n - r} \]</div>
<p>We now want to take a limit as <span class="math notranslate nohighlight">\(n\to \infty\)</span>, i.e. as the size of the subunits of time become smaller and smaller. Of course in doing this the probability <span class="math notranslate nohighlight">\(p\)</span> will change. Let’s assume that it just scales linearly:  i.e. the probability of an accident in a given minute is 60 times the probability of an accident in a given second. This is a reasonable assumption if:</p>
<ul class="simple">
<li><p>Everything for a given subunit size is IID; and</p></li>
<li><p>the subunits are small enough that only one accident can happen at a time.</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(p = n \lambda\)</span> for some parameter <span class="math notranslate nohighlight">\(\lambda\)</span> and then we take the limit of <span class="math notranslate nohighlight">\(P(Y=r)\)</span> above:</p>
<div class="math notranslate nohighlight">
\[ P(Y=r) = \lim_{n\to \infty} \binom{n}{r} \left( \frac{\lambda}{n} \right)^r \left( 1 - \frac{\lambda}{n} \right)^{n-r} \]</div>
<p>We expand out the binomial coefficient:</p>
<div class="math notranslate nohighlight">
\[ = \lim_{n\to \infty} \frac{n (n-1) \cdots (n-r+1)}{r!} \left( \frac{\lambda}{n} \right)^r \left( 1 - \frac{\lambda}{n} \right)^{n-r} \]</div>
<p>factor the <span class="math notranslate nohighlight">\(\lambda/n\)</span> and <span class="math notranslate nohighlight">\(1- \lambda/n\)</span> terms apart and recombine:</p>
<div class="math notranslate nohighlight">
\[ = \lim_{n\to \infty} \frac{\lambda^r}{r!} \left(1 - \frac{\lambda}{n} \right)^n \cdot \frac{ n (n-1) \cdots (n-r+1)}{n^r} \left(1 - \frac{\lambda}{n}\right)^{-r} \]</div>
<p>expand the numerator of the fraction and factor out the parts not depending on <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="math notranslate nohighlight">
\[ = \frac{\lambda^r}{r!} \lim_{n\to \infty} \left(1 - \frac{\lambda}{n}\right)^n \left(1 - \frac{\lambda}{n}\right)^{-r} \left(1 - \frac{1}{n}\right) \left( 1 - \frac{2}{n} \right) \cdots \left( 1- \frac{r-1}{n} \right) \]</div>
<p>Now inside the limit, all but the first factor only depends on <span class="math notranslate nohighlight">\(n\)</span> inside of the parenthesis; each of this is going to 1. We also recall that</p>
<div class="math notranslate nohighlight">
\[ \lim_{n\to \infty} \left(1 - \frac{\lambda}{n}\right)^n = e^{-\lambda} \]</div>
<p>and putting it all back together we have:</p>
<div class="math notranslate nohighlight">
\[ P(Y=r) = \frac{\lambda^r}{r!} e^{-\lambda} \]</div>
<div class="section" id="what-have-we-learned">
<h3>What have we learned?<a class="headerlink" href="#what-have-we-learned" title="Permalink to this headline">¶</a></h3>
<p>So we now have a definition:  A random variable <span class="math notranslate nohighlight">\(Y\)</span> is called a Poisson Process if it is coming from a trial that has the following property <strong><span class="math notranslate nohighlight">\(Y\)</span> is the number of events happening in a unit of time, distance, area, volume or any thing which can be subdivide into smaller and smaller pieces which has the propeerty that for small enough subdivisions the events can only happen once and the likliehood that they happen becomes an identical independent Bernoulie trial.</strong> Interestingly, small deviations from this assumption will still yield a good approximation.</p>
<p>The probability distribution of a Poisson Process satisfies the probability distribution for <span class="math notranslate nohighlight">\(r \geq 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[P(Y=r) = \frac{\lambda^r}{r!} e^{-\lambda} \]</div>
<p>with some parameter <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span>.</p>
<div class="section" id="plotting-the-distribution">
<h4>Plotting the Distribution<a class="headerlink" href="#plotting-the-distribution" title="Permalink to this headline">¶</a></h4>
<p>This distribution is coded in R as <em>dpois</em>, lets plot the distribution for the first few <span class="math notranslate nohighlight">\(r\)</span> with a given <span class="math notranslate nohighlight">\(\lambda\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lambda</span> <span class="o">&lt;-</span> <span class="m">1.1</span>
<span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">100</span><span class="p">)</span>
<span class="n">v</span> <span class="o">&lt;-</span> <span class="nf">dpois</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">lambda</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04-Geometric_and_Poisson_17_0.png" src="_images/04-Geometric_and_Poisson_17_0.png" />
</div>
</div>
<p>What is the effect of increasing <span class="math notranslate nohighlight">\(\lambda\)</span>?  Decreasing <span class="math notranslate nohighlight">\(\lambda\)</span>?</p>
</div>
<div class="section" id="cummulative-distribution">
<h4>Cummulative Distribution<a class="headerlink" href="#cummulative-distribution" title="Permalink to this headline">¶</a></h4>
<p>The cumulative distribution, the probability that <span class="math notranslate nohighlight">\(Y \leq r\)</span>, can be plotted, it is coded in R as <em>ppois</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lambda</span> <span class="o">&lt;-</span> <span class="m">1.1</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="m">100</span> <span class="c1"># The upper bound on n for our plot</span>
<span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="o">:</span><span class="p">(</span><span class="m">10</span><span class="o">*</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="m">10</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nf">ppois</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">lambda</span><span class="p">),</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/04-Geometric_and_Poisson_19_0.png" src="_images/04-Geometric_and_Poisson_19_0.png" />
</div>
</div>
<p>Again what is the effect of changing <span class="math notranslate nohighlight">\(\lambda\)</span>?  Make a prediction before you draw the graph. Again you may have to increase the fineness of our mesh in order for the graph to render correctly.</p>
</div>
</div>
<div class="section" id="id2">
<h3>Expected Value<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>So let’s suppose we have found that <span class="math notranslate nohighlight">\(\lambda = 1.1\)</span> for our intersection (we will return to finding <span class="math notranslate nohighlight">\(\lambda\)</span> from data later). How many accidents do we expect to see each week?  I.e. over the long term if we take the mean of the number of accidents what will we find?</p>
<p>Using R we can approximate it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">100</span><span class="p">)</span>
<span class="n">lambda</span> <span class="o">&lt;-</span> <span class="m">1.1</span>
<span class="nf">sum</span><span class="p">(</span> <span class="n">r</span><span class="o">*</span><span class="nf">dpois</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">lambda</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1.1</div></div>
</div>
<p>Which seems well…. <strong>clearly we should be able to show that this will always happen!</strong></p>
<div class="math notranslate nohighlight">
\[ E(Y) = \sum_{r =0}^\infty r P(Y=r) = \sum_{r=0}^\infty r \frac{\lambda^r}{r!} e^{-\lambda} \]</div>
<p>Again I will note here that the distributions for which we have names are the ones for which the mathematical structure tends to give us formulas with which we can actually do something.  We will talk as the course goes on about why this works, and what we can do more generally.</p>
<p>Continuing:</p>
<div class="math notranslate nohighlight">
\[ E(Y) = e^{-\lambda} \sum_{r=1}^\infty \frac{\lambda^r}{(r-1)!} \]</div>
<div class="math notranslate nohighlight">
\[ = \lambda e^{-\lambda} \sum_{s=0}^\infty \frac{\lambda^s}{s!} = \lambda e^{-\lambda} e^{\lambda} = \lambda\]</div>
<p>So the <span class="math notranslate nohighlight">\(\lambda\)</span> parameter for our Poisson Distribution is exactly the expected value of the random variable.</p>
</div>
<div class="section" id="variance-of-the-poisson-random-variable">
<h3>Variance of the Poisson Random Variable<a class="headerlink" href="#variance-of-the-poisson-random-variable" title="Permalink to this headline">¶</a></h3>
<p>We can also compute the variance, using again our shortcut:  <span class="math notranslate nohighlight">\(V(Y) = E(Y^2) - \mu^2\)</span> where <span class="math notranslate nohighlight">\(\mu = E(Y)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">100</span><span class="p">)</span>
<span class="n">lambda</span> <span class="o">&lt;-</span> <span class="m">1.1</span>
<span class="nf">sum</span><span class="p">(</span> <span class="n">r^2</span><span class="o">*</span><span class="nf">dpois</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">lambda</span><span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="n">lambda^2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1.1</div></div>
</div>
<p><strong>I would forgive you if you are wondering if maybe we just made a mistake!</strong></p>
<p>As before the trick to use is that <span class="math notranslate nohighlight">\(E(Y^2) = E(Y(Y-1)) + E(Y)\)</span></p>
<div class="math notranslate nohighlight">
\[ E(Y(Y-1)) = \sum_{r=0}^\infty r (r-1) \frac{\lambda^r}{r!} e^{-\lambda} = e^{-\lambda} \sum_{r=2}^\infty \frac{\lambda}{(r-2)!}  \]</div>
<p>and we find</p>
<div class="math notranslate nohighlight">
\[ = \lambda^2 e^{-\lambda} \sum_{s=0}^\infty \frac{\lambda^s}{s!} = \lambda^2 \]</div>
<p>Putting it together we have:</p>
<div class="math notranslate nohighlight">
\[ V(Y) = \lambda^2 + \lambda - \lambda^2 = \lambda\]</div>
<p>So in summary a Poisson random variable with parameter <span class="math notranslate nohighlight">\(\lambda\)</span> has expected value and variance <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div>
</div>
<div class="section" id="using-the-cummulative-distribution">
<h2>Using the Cummulative Distribution<a class="headerlink" href="#using-the-cummulative-distribution" title="Permalink to this headline">¶</a></h2>
<p>Consider our dangerous intersection that we now know has 1.1 accidents per week. Find an upper bound for the number of accidents we will have 95% of the time. Mean we want to find the smallest <span class="math notranslate nohighlight">\(r\)</span> such that <span class="math notranslate nohighlight">\(P(Y \leq r) \geq 0.95\)</span>.</p>
<p>The <em>qpois</em> function is the inverse Cummulative Distribution Function. It takes a probability <span class="math notranslate nohighlight">\(0\leq q \leq 1\)</span> and returns the value <span class="math notranslate nohighlight">\(r\)</span> such that <span class="math notranslate nohighlight">\(P(Y\leq r) = q\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">qpois</span><span class="p">(</span><span class="m">0.95</span><span class="p">,</span> <span class="m">1.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">3</div></div>
</div>
<p>Note that because the probability is discrete the result is not that the CDF is exactly 0.95 here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ppois</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">1.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.974258183470329</div></div>
</div>
<p>Meanwhile, the likliehood that we will go a week with 3 or more accidents is <span class="math notranslate nohighlight">\(P(Y \geq 3)\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="o">-</span> <span class="nf">ppois</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">1.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.0995837185966948</div></div>
</div>
<p>For a given value of <span class="math notranslate nohighlight">\(\lambda\)</span> we can play variations on these games for any number of combinations.</p>
</div>
<div class="section" id="moments-and-moment-generating-functions">
<h2>Moments and Moment Generating Functions<a class="headerlink" href="#moments-and-moment-generating-functions" title="Permalink to this headline">¶</a></h2>
<p>One idea which we will need later in class and we should introduce now is that of finding moments. We have seen that <em>Expected Value</em> and <em>Variance</em> have uses in characterizing a distribution, and for distributions with sufficient symmetry are things we can compute exactly. In an effort to characeterize distributions more broadly one is then led to consider the question of moments. The <span class="math notranslate nohighlight">\(m\)</span>’th moment of a distribution is defined to be:</p>
<div class="math notranslate nohighlight">
\[ E(Y^m) \]</div>
<p>We then define the <em>Moment Generating Function</em> of a random variable to be:</p>
<div class="math notranslate nohighlight">
\[ M(t) = E(e^{t Y} ) \]</div>
<p>provided that it exists.</p>
<p>This generates moments in the sense that provided that <span class="math notranslate nohighlight">\(t\)</span> is in an open interval where <span class="math notranslate nohighlight">\(M(t)\)</span> exists we have:</p>
<div class="math notranslate nohighlight">
\[ E(Y^k) = \frac{d^k}{dt^k} M(t) \bigg|_{t=0} \]</div>
<p>Two random variables with moment generating functions that exist and are equal are identical. Meaning that moment generating functions, if they exist, will uniquely characterize a distribution. This is a fact we will use once in this class in a few weeks.</p>
<div class="section" id="moment-generating-for-a-poisson-distribution">
<h3>Moment Generating for a Poisson Distribution<a class="headerlink" href="#moment-generating-for-a-poisson-distribution" title="Permalink to this headline">¶</a></h3>
<p>Let’s compute the moment generating function of the Poisson Distribution:</p>
<div class="math notranslate nohighlight">
\[ M(t) = \sum_{r=0}^\infty e^{t r - \lambda} \frac{\lambda^r}{r!} = e^{-\lambda} \sum_{r=0}^\infty \frac{\left( \lambda e^{t} \right)^r}{r!} = e^{\lambda (e^t - 1)} \]</div>
<p>If you go to the wikipedia page for any of our named distributions you will find their moment generating functions given.</p>
<p>An interesting question we unfortunately do not have time for is what the set of values of <span class="math notranslate nohighlight">\(t\)</span> for which <span class="math notranslate nohighlight">\(M(t)\)</span> exists tells us about the distribution.</p>
</div>
</div>
<div class="section" id="what-have-we-skipped">
<h2>What have we skipped?<a class="headerlink" href="#what-have-we-skipped" title="Permalink to this headline">¶</a></h2>
<p>There are couple of things we have carefully ignored. The main one being:</p>
<ul class="simple">
<li><p>While the Geometric and Poisson distributions are examples of how we can have a discrete random variable with infinitely many allowed values but with a distribution we can compute with; one might be wondering how can we work with an infinite discrete random varialbe that is for example uniform:  You are confronted with infinitely many doors, one of which has a car behind it and the rest of them goats. Can you choose one door at random with each door being equally likely that you will choose it?  If you do so, how likely is it that you will find the car rather than a goat?</p></li>
<li><p>For that matter, suppose you want to select a random integer to use when a date asks you “What is your favorite Integer?”  What are the chances you would select 1001?</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="03-Discrete_Probability.html" title="previous page">Discrete Random Variables - The Binomial Distribution</a>
    <a class='right-next' id="next-link" href="05-Continuous.html" title="next page">Continuous Random Variables</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>